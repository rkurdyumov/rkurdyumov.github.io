<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv='X-UA-Compatible' content='IE=EmulateIE7' />
<title>Software Design - ME218C: Team Oregon Trail</title>

<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>

<link rel='stylesheet' href='http://cdn1.weebly.com/editor/images/common/common.css?9' type='text/css' />
<link rel='stylesheet' type='text/css' href='files/main_style.css?1306803949' title='wsite-theme-css' />
<style type='text/css'>
#wsite-content div.paragraph, #wsite-content p, #wsite-content .product-description, .blog-sidebar div.paragraph, .blog-sidebar p{}
#wsite-content h2, #wsite-content .product-title, .blog-sidebar h2{}
#wsite-title{}
</style>
<style type='text/css'>
.wsite-header {
	background-image: url(uploads/7/6/4/8/7648233/header_images/1306797373.jpg) !important;
	background-position: 0 0 !important;
}
</style>
<script type='text/javascript'><!--
var STATIC_BASE = 'http://cdn1.weebly.com/';
var STYLE_PREFIX = 'wsite';
//-->
</script>
<script type='text/javascript' src='http://cdn1.weebly.com/libraries/prototype/1.7-custom/prototype.min.js'></script>
<script type='text/javascript' src='http://cdn1.weebly.com/libraries/scriptaculous/1.9.0-custom/effects.min.js'></script>
<script type='text/javascript' src='http://cdn1.weebly.com/editor/images/common/utilities.js?2'></script>
<script type='text/javascript' src='http://cdn1.weebly.com/editor/images/common/lightbox202.js?9'></script>
<script type='text/javascript' src='http://cdn1.weebly.com/editor/libraries/flyout_menus.js?13'></script>
<script type='text/javascript'><!--
var IS_ARCHIVE=1;
function initFlyouts(){initPublishedFlyoutMenus([{"id":"827577867979079627","title":"Home","url":"index.html"},{"id":"204663019954184299","title":"Meet the Team","url":"meet-the-team.html"},{"id":"395667095664308912","title":"Project Scope","url":"project-scope.html"},{"id":"417712849233469031","title":"Design Overview","url":"design-overview.html"},{"id":"420071610921579493","title":"Mechanical Design","url":"mechanical-design.html"},{"id":"944511565360168593","title":"Electrical Design","url":"electrical-design.html"},{"id":"940510528500066676","title":"Software Design","url":"software-design.html"},{"id":"623533585875987356","title":"Bill of Materials","url":"bill-of-materials.html"},{"id":"388808413366027315","title":"Gems of Wisdom","url":"gems-of-wisdom.html"},{"id":"640860537589248877","title":"Media","url":"media.html"}],'940510528500066676',"<li class='wsite-nav-more'><a href=\"#\">more...<\/a><\/li>",'active',false)}
if (Prototype.Browser.IE) window.onload=initFlyouts; else document.observe('dom:loaded', initFlyouts);
//-->
</script>
</head>
<body class='wsite-page-software-design'>
<div id="container">

<div id="banner">
<div id="bannerLeft" class="wsite-header"></div>
<div id="bannerRight">
<h1><span id="wsite-title">ME218C: Team Oregon Trail</span></h1>
</div>
</div>

<div id="content">

<div id="leftColumn">
<ul id="nav">
<li id='pg827577867979079627'><a href="index.html">Home</a></li><li id='pg204663019954184299'><a href="meet-the-team.html">Meet the Team</a></li><li id='pg395667095664308912'><a href="project-scope.html">Project Scope</a></li><li id='pg417712849233469031'><a href="design-overview.html">Design Overview</a></li><li id='pg420071610921579493'><a href="mechanical-design.html">Mechanical Design</a></li><li id='pg944511565360168593'><a href="electrical-design.html">Electrical Design</a></li><li id="active"><a href="software-design.html">Software Design</a></li><li id='pg623533585875987356'><a href="bill-of-materials.html">Bill of Materials</a></li><li id='pg388808413366027315'><a href="gems-of-wisdom.html">Gems of Wisdom</a></li><li id='pg640860537589248877'><a href="media.html">Media</a></li>

</ul>
<div id="leftColumnBottom"></p>

</div>
</div>

<div id="rightColumn">

<div id='wsite-content'><h2  style=" text-align: left; ">Overall Software Design<br /></h2>
<div  class="paragraph editable-text" style=" text-align: left; display: block; ">To successfully play a game, our software design had to accomplish several key tasks:<br /><ol><li>Obtain an ASCII RFID key when swiping an RFID card (must be coded in Assembly).</li><li>Convert that ASCII key to a HEX serial number.&nbsp; If necessary, get a corresponding security key from the security controller.</li><li>Send and receive XBee radio messages on both the boat and bike.</li></ol>Since we couldn't find one 16 series PIC that could do 2 and 3, the simplest PIC network we could design involved 3 PICs (after coding up our PICs, we did actually find dsPICs that could do 2 and 3, but it was too late to change):<br /></div>

<div ><div style="text-align: center;"><a><img src="uploads/7/6/4/8/7648233/3176040.png?511" style="margin-top: 10px; margin-bottom: 10px; margin-left: 10px; margin-right: 10px; border-width:1px;padding:3px;" alt="Picture" class="galleryImageBorder" /></a><div style="display: block; font-size: 90%; margin-top: -10px; margin-bottom: 10px;"></div></div></div>

<div  class="paragraph editable-text" style=" text-align: left; ">The RFID PIC (16F690) did task 1.&nbsp; The security PIC (16F690) did task 2.&nbsp; The Main PIC (16F777) and the E128 did task 3.&nbsp; We interfaced our three PICs using SPI.&nbsp; For simplicity, we made the Security PIC a master - it would retrieve an RFID key and send out a serial number and security key to the Main PIC.&nbsp; The RFID PIC signaled that it had a new key by lowering an I/O line tied to the Security PIC.<br /></div>

<h2  style=" text-align: left; ">Process Flow Diagrams<br /></h2>
<div  class="paragraph editable-text" style=" text-align: left; display: block; ">The state machines for the RFID and security PICs were straighforward and always followed the same state progression.&nbsp; Instead we've attached the process flow diagrams, which quickly communicate the basic software design:<br /></div>

<div ><div style="text-align: center;"><a><img src="uploads/7/6/4/8/7648233/1919296.png?491" style="margin-top: 10px; margin-bottom: 10px; margin-left: 10px; margin-right: 10px; border-width:1px;padding:3px;" alt="Picture" class="galleryImageBorder" /></a><div style="display: block; font-size: 90%; margin-top: -10px; margin-bottom: 10px;"></div></div></div>

<div ><div style="text-align: center;"><a><img src="uploads/7/6/4/8/7648233/2047927.png?492" style="margin-top: 10px; margin-bottom: 10px; margin-left: 10px; margin-right: 10px; border-width:1px;padding:3px;" alt="Picture" class="galleryImageBorder" /></a><div style="display: block; font-size: 90%; margin-top: -10px; margin-bottom: 10px;"></div></div></div>

<div  class="paragraph editable-text" style=" text-align: left; ">Our RFID PIC originally had timeouts built in in case we didn't get a full RFID message, but this never occurred throughout the project and we had problems with using Timer0, so we took them out.<br /><br /><span>Note that <span style="font-weight: bold;">every </span>RFID scan proceeds through the above process diagrams.&nbsp; To avoid putting in lookup tables in our Security PIC, we try to get a security key for all card swipes, even color card swipes.&nbsp; On the Main PIC, once we determine that we've received a color swipe serial number, we just ignore the security key that was sent with it.</span><br /><a href="uploads/7/6/4/8/7648233/securitypic.c.html"><span></span></a><br /></div>

<h2  style=" text-align: left; ">Communication State Machines</h2>

<div ><div style="text-align: left;"><a><img src="uploads/7/6/4/8/7648233/5048700.png?522" style="margin-top: 10px; margin-bottom: 10px; margin-left: 0; margin-right: 10px; border-width:1px;padding:3px;" alt="Picture" class="galleryImageBorder" /></a><div style="display: block; font-size: 90%; margin-top: -10px; margin-bottom: 10px;"></div></div></div>

<div ><div style="text-align: right;"><a><img src="uploads/7/6/4/8/7648233/8405182.png?504" style="margin-top: 10px; margin-bottom: 10px; margin-left: 10px; margin-right: 0; border-width:1px;padding:3px;" alt="Picture" class="galleryImageBorder" /></a><div style="display: block; font-size: 90%; margin-top: -10px; margin-bottom: 10px;"></div></div></div>

<h2  style=" text-align: left; ">Main PIC State Machine</h2>

<div ><div style="text-align: left;"><a><img src="uploads/7/6/4/8/7648233/9758115.png?522" style="margin-top: 10px; margin-bottom: 10px; margin-left: 0; margin-right: 10px; border-width:1px;padding:3px;" alt="Picture" class="galleryImageBorder" /></a><div style="display: block; font-size: 90%; margin-top: -10px; margin-bottom: 10px;"></div></div></div>

<h2  style=" text-align: left; ">Code Listings<br /></h2>

<div ><div id="275255754210273204-parent" class="wsite-splitpane-2" style="width: 100%;">
  <div id="275255754210273204-lhs" class="column" style="width: 49.5%; float: left; overflow: visible; margin: 0; padding: 0;">
    <div style="padding-right: 5px;" class="columnlistp">
       <h2  style=" text-align: left; ">CVC: E128 Code Listings<br /></h2>
<div  class="paragraph editable-text" style=" text-align: left; display: block; "><span style="font-weight: bold; text-decoration: underline;">E128:</span><br /><span></span><a title="" href="uploads/7/6/4/8/7648233/main_rev2.c.html">main.c</a> / <a href="uploads/7/6/4/8/7648233/main.txt">main.txt</a><br /><span></span><a title="" href="uploads/7/6/4/8/7648233/e128_io.c.html">E128_IO.c</a> / <a title="" href="uploads/7/6/4/8/7648233/e128_io.h.html">E128_IO.h<span></span></a> / <a href="uploads/7/6/4/8/7648233/e128_io.txt">E128_IO.txt</a><br /><a title="" href="uploads/7/6/4/8/7648233/communication.h.html"><span>Communication.h</span></a><br /><span></span><br /></div>


    </div>
  </div>
  <div id="275255754210273204-rhs" class="column" style="width: 49.5%; left: 49.5%; float: left; overflow: visible; margin: 0; padding: 0;">
    <div style="padding-left: 5px;" class="columnlistp">
       <h2  style=" text-align: left; ">ACV: PIC Code Listings<br /></h2>
<div  class="paragraph editable-text" style=" text-align: left; display: block; "><span style="font-weight: bold; text-decoration: underline;">RFID PIC: </span><br /><span></span><a title="" href="uploads/7/6/4/8/7648233/rfidmain.asm.html">RFIDMain.asm</a> / <a title="" href="uploads/7/6/4/8/7648233/rfid.txt"><span>RFIDMain.txt</span></a><br /><br /><span style="font-weight: bold; text-decoration: underline;">Security PIC:</span><br /><span></span><a title="" href="uploads/7/6/4/8/7648233/securitypic.c.html">SecurityPIC.c</a> / <a href="uploads/7/6/4/8/7648233/securitypic.txt"><span>SecurityP</span>IC.txt</a><br /><br /><span style="font-weight: bold; text-decoration: underline;">Main PIC:</span><br /><span></span><a title="" href="uploads/7/6/4/8/7648233/mainpic.c.html">MainPIC.c</a> / <a href="uploads/7/6/4/8/7648233/mainpic.txt">MainPIC.txt</a><br /><span></span><a title="" href="uploads/7/6/4/8/7648233/scimessage.c.html">SCIMessage.c</a> / <a title="" href="uploads/7/6/4/8/7648233/scimessage.h.html">SCIMessage.h</a> / <a href="uploads/7/6/4/8/7648233/scimessage.txt">SCIMessage.txt</a><br /><span></span><a title="" href="uploads/7/6/4/8/7648233/mainio.c.html">MainIO.c</a> / <a title="" href="uploads/7/6/4/8/7648233/mainio.h.html">MainIO.h</a> / <a href="uploads/7/6/4/8/7648233/mainio.txt">MainIO.txt</a><br /><span></span><a title="" href="uploads/7/6/4/8/7648233/timerpic.c.html">TimerPIC.c</a> / <a title="" href="uploads/7/6/4/8/7648233/timerpic.h.html">TimerPIC.h</a> / <a href="uploads/7/6/4/8/7648233/timerpic.txt">TimerPIC.txt</a><br /><span></span><a title="" href="uploads/7/6/4/8/7648233/communication.h.html">Communication.h</a><br /><a title="" href="uploads/7/6/4/8/7648233/messages.h.html"><span>Messages.h</span></a><br /><span></span><a title="" href="uploads/7/6/4/8/7648233/timernumber.h.html">TimerNumber.h</a><br /><span></span><br /></div>

 
    </div>
  </div>

  

</div>

<div style="clear: both; visibility: hidden; height: 0px; overflow: hidden;"></div></div>

<div  class="paragraph editable-text" style=" text-align: left; ">Alternatively, you can download all the code in a zip file below:<br /><a href="uploads/7/6/4/8/7648233/completecode.zip"><span>CompleteCode.zip</span></a><br /></div>

</div>

</div>

<div id="clear">
</div>

</div>

</div>
<div id="copyright"> <span id='weeblyFooter'>Create a <a target="_top" href="http://www.weebly.com/">free web site</a> with <a target="_top" href="http://www.weebly.com/" title="free web site">Weebly</a></span></div>

</body>
</html>